<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Tooba Rahimnia">
<meta name="dcterms.date" content="2024-07-13">

<title>CognitiveDiscoveries - How to Create a Web App with Django and YOLOv10 Models on Your Custom Dataset</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/videojs/video.min.js"></script>
<link href="../../site_libs/quarto-contrib/videojs/video-js.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">CognitiveDiscoveries</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/toobarahimnia"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://linkedin.com/in/tooba-rahimnia"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:trahimnia@gmail.com"> <i class="bi bi-envelope" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">How to Create a Web App with Django and YOLOv10 Models on Your Custom Dataset</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Web App</div>
                <div class="quarto-category">Computer Vision</div>
                <div class="quarto-category">Django</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Tooba Rahimnia </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">July 13, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#yolov10-overivew" id="toc-yolov10-overivew" class="nav-link active" data-scroll-target="#yolov10-overivew">YOLOv10 Overivew</a>
  <ul class="collapse">
  <li><a href="#model-variants" id="toc-model-variants" class="nav-link" data-scroll-target="#model-variants">Model Variants</a></li>
  <li><a href="#architecture-design" id="toc-architecture-design" class="nav-link" data-scroll-target="#architecture-design">Architecture Design</a></li>
  <li><a href="#key-features" id="toc-key-features" class="nav-link" data-scroll-target="#key-features">Key Features</a></li>
  <li><a href="#performance-comparison" id="toc-performance-comparison" class="nav-link" data-scroll-target="#performance-comparison">Performance Comparison</a></li>
  </ul></li>
  <li><a href="#custom-model" id="toc-custom-model" class="nav-link" data-scroll-target="#custom-model">Custom Model</a>
  <ul class="collapse">
  <li><a href="#install-ultralytics-packages" id="toc-install-ultralytics-packages" class="nav-link" data-scroll-target="#install-ultralytics-packages">Install Ultralytics packages</a></li>
  <li><a href="#download-pre-trained-model-weights" id="toc-download-pre-trained-model-weights" class="nav-link" data-scroll-target="#download-pre-trained-model-weights">Download Pre-trained Model Weights</a></li>
  <li><a href="#download-datasets-from-roboflow" id="toc-download-datasets-from-roboflow" class="nav-link" data-scroll-target="#download-datasets-from-roboflow">Download datasets from Roboflow</a></li>
  <li><a href="#fine-tune-the-model" id="toc-fine-tune-the-model" class="nav-link" data-scroll-target="#fine-tune-the-model">Fine-tune the Model</a></li>
  <li><a href="#visualization-and-analysis" id="toc-visualization-and-analysis" class="nav-link" data-scroll-target="#visualization-and-analysis">Visualization and Analysis</a></li>
  <li><a href="#testing-the-model" id="toc-testing-the-model" class="nav-link" data-scroll-target="#testing-the-model">Testing the Model</a></li>
  </ul></li>
  <li><a href="#web-app" id="toc-web-app" class="nav-link" data-scroll-target="#web-app">Web App</a>
  <ul class="collapse">
  <li><a href="#setting-up-virtual-environment" id="toc-setting-up-virtual-environment" class="nav-link" data-scroll-target="#setting-up-virtual-environment">Setting up Virtual Environment</a></li>
  <li><a href="#install-django" id="toc-install-django" class="nav-link" data-scroll-target="#install-django">Install Django</a></li>
  <li><a href="#start-project" id="toc-start-project" class="nav-link" data-scroll-target="#start-project">Start project</a></li>
  <li><a href="#add-application" id="toc-add-application" class="nav-link" data-scroll-target="#add-application">Add Application</a></li>
  <li><a href="#create-templates---frontend" id="toc-create-templates---frontend" class="nav-link" data-scroll-target="#create-templates---frontend">Create Templates - Frontend</a></li>
  <li><a href="#urls-routing" id="toc-urls-routing" class="nav-link" data-scroll-target="#urls-routing">URLs Routing</a></li>
  <li><a href="#backend" id="toc-backend" class="nav-link" data-scroll-target="#backend">Backend</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  <li><a href="#deploy-locally" id="toc-deploy-locally" class="nav-link" data-scroll-target="#deploy-locally">Deploy Locally</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>In this blog, we will learn about YOLOv10 models and how to train one on a custom dataset to develop a real-time object detection web application using Django.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="pexels-frischluft-22021132.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>Machine learning, a subset of artificial intelligence, has revolutionized data handling and prediction making. Among its various applications, computer vision is particularly noteworthy, allowing machines to interpret and comprehend visual data similarly to humans.</p>
<p>The influence of computer vision is profound, revolutionizing healthcare, advancing automation, and bolstering security measures. Real-time object detection enables accurate identification of object categories and positions in images with minimal delay. The YOLO series has led the charge in this area, striking a perfect balance between performance and efficiency.</p>
<section id="yolov10-overivew" class="level2">
<h2 class="anchored" data-anchor-id="yolov10-overivew">YOLOv10 Overivew</h2>
<p><strong>YOLO</strong> stands for <strong>You Only Look Once</strong>. It’s a family of models designed for real-time object detection. From image pixels to bounding box coordinates, the main idea behind YOLO is to frame object detection as a single regression task.</p>
<p>A few months ago, researchers at <a href="https://www.tsinghua.edu.cn/en/">Tsinghua University</a> unveiled YOLOv10, a novel approach to real-time object detection. This new model addresses the post-processing and architectural shortcomings of previous YOLO versions. By eliminating non-maximum suppression (NMS), YOLOv10 achieves state-of-the-art performance with significantly reduced computational overhead.</p>
<section id="model-variants" class="level3">
<h3 class="anchored" data-anchor-id="model-variants">Model Variants</h3>
<p>YOLOv10 comes in various model scales to address different application needs:</p>
<ul>
<li><p><strong>YOLOv10-N</strong>: Nano version for extremely resource-constrained environments.</p></li>
<li><p><strong>YOLOv10-S</strong>: Small version balancing speed and accuracy.</p></li>
<li><p><strong>YOLOv10-M</strong>: Medium version for general-purpose use.</p></li>
<li><p><strong>YOLOv10-B</strong>: Balanced version with increased width for higher accuracy.</p></li>
<li><p><strong>YOLOv10-L</strong>: Large version for higher accuracy at the cost of increased computational resources.</p></li>
<li><p><strong>YOLOv10-X</strong>: Extra-large version for maximum accuracy and performance.</p></li>
</ul>
</section>
<section id="architecture-design" class="level3">
<h3 class="anchored" data-anchor-id="architecture-design">Architecture Design</h3>
<p>The YOLOv10 architecture builds upon the strengths of previous YOLO models while introducing key innovations for even better performance.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="model.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>The components of the architecture shown in Figure 2 above are as follows:</p>
<ul>
<li><p><strong>Input Image:</strong></p>
<ul>
<li>The model takes an image as input. This image is usually resized to a fixed size (e.g., 640x640 pixels).</li>
</ul></li>
<li><p><strong>Backbone:</strong></p>
<ul>
<li><p>This is a convolutional neural network (CNN) that extracts features from the input image. The backbone is often a modified version of a well-known CNN like CSPDarknet or a more efficient variant.</p></li>
<li><p>The backbone consists of several convolutional layers that help detect edges, textures, patterns, and more complex structures.</p></li>
</ul></li>
<li><p><strong>Neck:</strong></p>
<ul>
<li><p>The neck connects the backbone to the head of the model. It consists of additional layers that further process the features extracted by the backbone.</p></li>
<li><p>YOLOv10 uses techniques like PANet (Path Aggregation Network) to improve feature fusion from different layers, enhancing the detection capability for objects at different scales.</p></li>
</ul></li>
<li><p><strong>Head:</strong></p>
<ul>
<li><p>The head is responsible for predicting bounding boxes and class probabilities.</p></li>
<li><p><strong>One-to-Many Head</strong>: Generates multiple predictions per object during training to provide rich supervisory signals and improve learning accuracy.</p></li>
<li><p><strong>One-to-One Head</strong>: Generates a single best prediction per object during inference to eliminate the need for NMS, thereby reducing latency and improving efficiency.</p></li>
<li><p>YOLOv10 uses anchor boxes to predict the location and size of objects. Anchor boxes are predefined boxes of different shapes and sizes that help the model generalize better to various object shapes.</p></li>
<li><p>The head outputs three types of information for each anchor box: the coordinates of the bounding box, the objectness score (how likely it is that an object is present), and the class probabilities (what kind of object it is).</p></li>
</ul></li>
<li><p><strong>Output:</strong></p>
<ul>
<li><p>The model outputs a grid of predictions, where each cell in the grid predicts multiple bounding boxes and their corresponding class probabilities.</p></li>
<li><p>Non-Maximum Suppression (NMS) is used to filter out overlapping boxes, keeping only the best ones to avoid duplicate detections.</p></li>
</ul></li>
</ul>
</section>
<section id="key-features" class="level3">
<h3 class="anchored" data-anchor-id="key-features">Key Features</h3>
<div class="quarto-video"><video id="video_shortcode_videojs_video1" class="video-js vjs-default-skin vjs-fluid" controls="" preload="auto" data-setup="{}" title=""><source src="test_vid.mp4"></video></div>
<ul>
<li><strong>No NMS Training</strong>: Uses a new method to avoid non-maximum suppression (NMS), speeding up the inference (prediction) process.</li>
<li><strong>Complete Model Design</strong>: Optimizes different parts of the model for better speed and accuracy, including lighter classification heads and improved downsampling techniques.</li>
<li><strong>Improved Model Features</strong>: Adds larger convolutions and self-attention techniques to boost performance without adding much extra computing power.</li>
</ul>
</section>
<section id="performance-comparison" class="level3">
<h3 class="anchored" data-anchor-id="performance-comparison">Performance Comparison</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="result_model.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>YOLOv10 models, including YOLOv10-S and YOLOv10-X, offer significant speed advantages, being 1.8× and 1.3× faster than RT-DETR-R18 and R101 while maintaining comparable accuracy. Additionally, YOLOv10-B has 25% fewer parameters and 46% lower latency than YOLOv9-C, achieving the same level of accuracy. Furthermore, YOLOv10-L and YOLOv10-X exceed the performance of YOLOv8-L and YOLOv8-X by 0.3 AP and 0.5 AP, respectively, while requiring 1.8× and 2.3× fewer parameters. Overall, YOLOv10 demonstrates a compelling balance of efficiency and performance compared to other state-of-the-art detectors.</p>
</section>
</section>
<section id="custom-model" class="level2">
<h2 class="anchored" data-anchor-id="custom-model">Custom Model</h2>
<p><img src="Screenshot 2024-07-12 at 6.04.54 PM.png" class="img-fluid"></p>
<p>Now, let’s dive into the exciting part—implementation!</p>
<p>For our web application’s implementation, we will start by creating our custom model. For this first part, we will use Google Colab. Make sure to set the runtime to T4 GPU in the Runtime section. Once we have our new set of weights, we can download them and move on to Visual Studio Code to set up our Django environment. Let’s begin!</p>
<section id="install-ultralytics-packages" class="level3">
<h3 class="anchored" data-anchor-id="install-ultralytics-packages">Install Ultralytics packages</h3>
<p>Before we start coding, we need to install the YOLOv10 package directly from the GitHub repository. We will also need to install Roboflow to access our dataset.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="op">!</span>pip install <span class="op">-</span>q git<span class="op">+</span>https:<span class="op">//</span>github.com<span class="op">/</span>THU<span class="op">-</span>MIG<span class="op">/</span>yolov10.git</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="op">!</span>pip install <span class="op">-</span>q roboflow</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="download-pre-trained-model-weights" class="level3">
<h3 class="anchored" data-anchor-id="download-pre-trained-model-weights">Download Pre-trained Model Weights</h3>
<p>In this part, we are creating a new repository in our Colab environment called <code>weights</code>. This repository will store all the pre-trained model weights for all YOLOv10 models.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="im">import</span> os</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="im">import</span> urllib.request</span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co"># create a directory for weights in the current working directory</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>weights_dir <span class="op">=</span> os.path.join(os.getcwd(), <span class="st">'weights'</span>)</span>
<span id="cb2-6"><a href="#cb2-6"></a>os.makedirs(weights_dir, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb2-7"><a href="#cb2-7"></a></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co"># URLs of the weight files</span></span>
<span id="cb2-9"><a href="#cb2-9"></a>urls <span class="op">=</span> [</span>
<span id="cb2-10"><a href="#cb2-10"></a>    <span class="st">'https://github.com/THU-MIG/yolov10/releases/download/v1.1/yolov10n.pt'</span>,</span>
<span id="cb2-11"><a href="#cb2-11"></a>    <span class="st">'https://github.com/THU-MIG/yolov10/releases/download/v1.1/yolov10s.pt'</span>,</span>
<span id="cb2-12"><a href="#cb2-12"></a>    <span class="st">'https://github.com/THU-MIG/yolov10/releases/download/v1.1/yolov10m.pt'</span>,</span>
<span id="cb2-13"><a href="#cb2-13"></a>    <span class="st">'https://github.com/THU-MIG/yolov10/releases/download/v1.1/yolov10b.pt'</span>,</span>
<span id="cb2-14"><a href="#cb2-14"></a>    <span class="st">'https://github.com/THU-MIG/yolov10/releases/download/v1.1/yolov10x.pt'</span>,</span>
<span id="cb2-15"><a href="#cb2-15"></a>    <span class="st">'https://github.com/THU-MIG/yolov10/releases/download/v1.1/yolov10l.pt'</span></span>
<span id="cb2-16"><a href="#cb2-16"></a>]</span>
<span id="cb2-17"><a href="#cb2-17"></a></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="co"># download files</span></span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="cf">for</span> url <span class="kw">in</span> urls:</span>
<span id="cb2-20"><a href="#cb2-20"></a>    file_name <span class="op">=</span> os.path.join(weights_dir, os.path.basename(url))</span>
<span id="cb2-21"><a href="#cb2-21"></a>    urllib.request.urlretrieve(url, file_name)</span>
<span id="cb2-22"><a href="#cb2-22"></a>    <span class="bu">print</span>(<span class="ss">f'Downloaded </span><span class="sc">{</span>file_name<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="download-datasets-from-roboflow" class="level3">
<h3 class="anchored" data-anchor-id="download-datasets-from-roboflow">Download datasets from Roboflow</h3>
<p>For the custom dataset collection, I am using <a href="https://universe.roboflow.com">Roboflow Universe</a>. It contains over 500,000 datasets and supports our model type. You can search for any keyword to find images in the search bar. An example of a dataset I used for training my model includes over 2,900 images of <a href="https://universe.roboflow.com/jonac22/persons-and-cars/dataset/3">people and cars</a>.</p>
<p>Once you’ve chosen your dataset, click on the <em>Download Dataset</em> button in the top right corner. Next, select <code>YOLOv8</code> as the format and press <em>Continue</em>. You should now see a code snippet similar to the one shown in the picture below. Copy this code into your Colab notebook and run it.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Screenshot 2024-07-12 at 8.40.54 PM.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="439"></p>
</figure>
</div>
</section>
<section id="fine-tune-the-model" class="level3">
<h3 class="anchored" data-anchor-id="fine-tune-the-model">Fine-tune the Model</h3>
<p>Once your dataset and pre-trained weights are downloaded, they will appear in the <em>Files</em> menu on the left sidebar. To find the path to your model, open the <em>weights</em> directory, select the model of your choice, copy its path, and paste it into your model’s path. For example, the path to the model <code>yolov10m.pt</code> is <code>/content/weights/yolov10m.pt</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="op">!</span>yolo task<span class="op">=</span>detect mode<span class="op">=</span>train epochs<span class="op">=</span><span class="dv">100</span> batch<span class="op">=</span><span class="dv">64</span> <span class="op">\</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>model<span class="op">=</span><span class="st">'/path/to/your/model'</span> \</span>
<span id="cb3-3"><a href="#cb3-3"></a>data<span class="op">=</span><span class="st">'/path/to/data.yaml'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For the data, click on the file name specific to your dataset. You will see a <code>data.yaml</code> file. Copy its path into the data’s path in your code. Before running the cell, you need to modify this <code>data.yaml</code> file. Double-click on the file. It should look like this:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Screenshot 2024-07-12 at 9.00.46 PM.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>You need to modify the paths to <code>test</code>, <code>train</code>, and <code>val</code> as shown above. Inside your dataset folder, there are test, train, and valid folders each containing images and labels. Copy the path for <em>images</em> for each of these three and paste them into their corresponding name.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Screenshot 2024-07-12 at 9.05.09 PM.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>Now save your changes and run the code to start training!</p>
</section>
<section id="visualization-and-analysis" class="level3">
<h3 class="anchored" data-anchor-id="visualization-and-analysis">Visualization and Analysis</h3>
<p>Upon completion of your training process, a new directory called runs will be created. This folder contains information about the confusion matrix, recall, precision, and mAP, allowing us to evaluate our model’s performance. Let’s take a closer look:</p>
<p>To find the path to the confusion matrix, navigate to the runs directory, then go to the detect folder and the train subfolder. You will see a file named <code>confusion_matrix.png</code>; copy its path below.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> Image</span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a>Image(filename<span class="op">=</span><span class="st">'/path/to/confusion_matrix.png'</span>, width<span class="op">=</span><span class="dv">600</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Ideally, we want all the diagonal cells from the top left to the bottom right to be dark blue, indicating that the predicted objects match the actual ones. The figure below shows that, given our number of iterations, the model nearly perfectly identified all people in most images (2006 out of 2387). However, it only predicted cars correctly in 208 images.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Unknown.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="654"></p>
</figure>
</div>
<p>Next, let’s look at the <code>results.png</code> file, which can also be found in the same directory as the confusion matrix.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a>Image(filename<span class="op">=</span><span class="st">'/path/to/results.png'</span>, width<span class="op">=</span><span class="dv">600</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Unknown-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>At a glance, we can see that our results align well with the smooth lines, which is promising! Let’s delve into the graphs for more insights.</p>
<p>For instance, the metrics/recall (B) indicates that most of the actual positive instances were correctly identified by the model.</p>
<p>Similarly, the metrics/precision (B) graph reveals that a significant majority of the items labeled as positive by the model are indeed accurate.</p>
<p>Overall, these are solid results!</p>
<p>Another key graph is the mAP (mean Average Precision), which plays a crucial role in model selection. While we’re currently looking at the results for <code>YOLOv10m</code>, previous comparisons showed that YOLOv10 outperformed all other state-of-the-art models in terms of COCO AP %.</p>
</section>
<section id="testing-the-model" class="level3">
<h3 class="anchored" data-anchor-id="testing-the-model">Testing the Model</h3>
<p>The final step before we close our Google Colab notebook is testing our model’s performance on the unseen dataset. inside the <code>runs/detect/train/weights</code> directory choose your best performing model, <code>best.pt</code>, copy its path into the <code>model_path</code>. And the path to the test image files is in your dataset folder.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a><span class="im">from</span> ultralytics <span class="im">import</span> YOLOv10</span>
<span id="cb6-2"><a href="#cb6-2"></a></span>
<span id="cb6-3"><a href="#cb6-3"></a>model_path <span class="op">=</span> <span class="st">'/path/to/model/best.pt'</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>model <span class="op">=</span> YOLOv10(model_path)</span>
<span id="cb6-5"><a href="#cb6-5"></a>results <span class="op">=</span> model(source<span class="op">=</span><span class="st">'/path/to/test/images'</span>, conf<span class="op">=</span><span class="fl">0.25</span>, save<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You can open a few of the resulting images to check if the detections were correct. Before proceeding to the next step, download the <code>yolov8n.pt</code> file and save it in a local directory where you plan to create your web app.</p>
</section>
</section>
<section id="web-app" class="level2">
<h2 class="anchored" data-anchor-id="web-app">Web App</h2>
<p>A few blogs ago, we learned how to use the Flask framework for a binary image classification web app. Now, we are going to use a new web framework called Django to develop a computer vision app.</p>
<p>Django’s scalability, versatility, rapid development, and security advantages make it a great platform to learn and a valuable skill to have in the software development world.</p>
<p>If you are new to Django, this <a href="https://docs.djangoproject.com/en/3.0/intro/tutorial01/">tutorial</a> is a great reference for creating apps. Give it a look, and once you’re ready, come back and continue here with me.</p>
<section id="setting-up-virtual-environment" class="level3">
<h3 class="anchored" data-anchor-id="setting-up-virtual-environment">Setting up Virtual Environment</h3>
<p>Create your web app folder and open it with VS Code. The next step is to create a virtual environment. I suggest using Mamba, and the process is as follows:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1"></a><span class="ex">mamba</span> create <span class="at">-n</span> your_env_name</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="ex">mamba</span> activate your_env_name</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now, in your terminal, type <code>which python</code>. The path for your Python interpreter should match the one used by your virtual environment. If it doesn’t, go to <strong>View -&gt; Command Palette…</strong>, and select the Python version from the path of your virtual environment.</p>
</section>
<section id="install-django" class="level3">
<h3 class="anchored" data-anchor-id="install-django">Install Django</h3>
<p>Let’s go ahead and install Django:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1"></a><span class="ex">pip</span> install django</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="start-project" class="level3">
<h3 class="anchored" data-anchor-id="start-project">Start project</h3>
<p>Here, we create our app inside our project’s directory:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1"></a><span class="ex">Python3</span> <span class="at">-m</span> django startproject mysite</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="bu">cd</span> mysite</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This will create all the necessary, basic website files such as settings and urls routing.</p>
</section>
<section id="add-application" class="level3">
<h3 class="anchored" data-anchor-id="add-application">Add Application</h3>
<p>Here we create our computer vision app called <code>object_detection</code>:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a>python manage.py startapp object_detection</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>While in the outer <code>mysite</code> directory, create a <code>media</code> folder. This folder will store all input and output files. Place the model you downloaded earlier (<code>yolovv8n.pt</code>) in <code>mysite</code> folder as well. Your project’s structure should now look like this:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode numberSource texinfo number-lines code-with-copy"><code class="sourceCode texinfo"><span id="cb11-1"><a href="#cb11-1"></a>├── myproject</span>
<span id="cb11-2"><a href="#cb11-2"></a>|   └── mysite</span>
<span id="cb11-3"><a href="#cb11-3"></a>│       └── mysite</span>
<span id="cb11-4"><a href="#cb11-4"></a>|       └── object_detection</span>
<span id="cb11-5"><a href="#cb11-5"></a>|       └── manage.py</span>
<span id="cb11-6"><a href="#cb11-6"></a>|       └── yolov8n.pt</span>
<span id="cb11-7"><a href="#cb11-7"></a>|       └── media</span>
<span id="cb11-8"><a href="#cb11-8"></a>|</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="create-templates---frontend" class="level3">
<h3 class="anchored" data-anchor-id="create-templates---frontend">Create Templates - Frontend</h3>
<p>We need to create the <code>templates</code> folder inside our <code>object_detection</code>. It contains <code>base.html</code> and <code>obj_dtc.html</code>. The <code>base.html</code> contains the main navigation bar, where in our case is the only object detection task.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode numberSource html number-lines code-with-copy"><code class="sourceCode html"><span id="cb12-1"><a href="#cb12-1"></a><span class="dt">&lt;</span><span class="kw">nav</span><span class="ot"> class</span><span class="op">=</span><span class="st">"navbar navbar-expand-sm bg-dark navbar-dark"</span><span class="dt">&gt;</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>  <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">"collapse navbar-collapse"</span><span class="ot"> id</span><span class="op">=</span><span class="st">"collapsibleNavbar"</span><span class="dt">&gt;</span></span>
<span id="cb12-3"><a href="#cb12-3"></a>    <span class="dt">&lt;</span><span class="kw">ul</span><span class="ot"> class</span><span class="op">=</span><span class="st">"navbar-nav"</span><span class="dt">&gt;</span></span>
<span id="cb12-4"><a href="#cb12-4"></a>      <span class="dt">&lt;</span><span class="kw">li</span><span class="ot"> class</span><span class="op">=</span><span class="st">"nav-item"</span><span class="dt">&gt;</span></span>
<span id="cb12-5"><a href="#cb12-5"></a>        <span class="dt">&lt;</span><span class="kw">a</span><span class="ot"> class</span><span class="op">=</span><span class="st">"nav-link"</span><span class="ot"> href</span><span class="op">=</span><span class="st">"obj_dtc"</span><span class="dt">&gt;</span>Object Detection<span class="dt">&lt;/</span><span class="kw">a</span><span class="dt">&gt;</span></span>
<span id="cb12-6"><a href="#cb12-6"></a>      <span class="dt">&lt;/</span><span class="kw">li</span><span class="dt">&gt;</span></span>
<span id="cb12-7"><a href="#cb12-7"></a>    <span class="dt">&lt;/</span><span class="kw">ul</span><span class="dt">&gt;</span></span>
<span id="cb12-8"><a href="#cb12-8"></a>  <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="dt">&lt;/</span><span class="kw">nav</span><span class="dt">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>the <code>href</code> will route to the configured url. We will set the configurations in <code>object_detection/urls.py</code>.</p>
<p><code>obj_dtc.html</code> will display the input and output media requested and received by the user.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode numberSource html number-lines code-with-copy"><code class="sourceCode html"><span id="cb13-1"><a href="#cb13-1"></a>{% if original_video or original_image %}</span>
<span id="cb13-2"><a href="#cb13-2"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">"row justify-content-center mt-4"</span><span class="dt">&gt;</span></span>
<span id="cb13-3"><a href="#cb13-3"></a>        <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">"col-md-5"</span><span class="dt">&gt;</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>            <span class="dt">&lt;</span><span class="kw">h2</span><span class="dt">&gt;</span>Original Media:<span class="dt">&lt;/</span><span class="kw">h2</span><span class="dt">&gt;</span></span>
<span id="cb13-5"><a href="#cb13-5"></a>            {% if original_video %}</span>
<span id="cb13-6"><a href="#cb13-6"></a>            <span class="dt">&lt;</span><span class="kw">video</span><span class="ot"> width</span><span class="op">=</span><span class="st">"450"</span><span class="ot"> height</span><span class="op">=</span><span class="st">"283"</span><span class="ot"> controls src</span><span class="op">=</span><span class="st">"{{ original_video }}"</span><span class="dt">&gt;</span></span>
<span id="cb13-7"><a href="#cb13-7"></a>            <span class="dt">&lt;/</span><span class="kw">video</span><span class="dt">&gt;</span> </span>
<span id="cb13-8"><a href="#cb13-8"></a>            {% elif original_image %}</span>
<span id="cb13-9"><a href="#cb13-9"></a>                <span class="dt">&lt;</span><span class="kw">img</span><span class="ot"> src</span><span class="op">=</span><span class="st">"{{ original_image }}"</span><span class="ot"> alt</span><span class="op">=</span><span class="st">"Original"</span><span class="ot"> width</span><span class="op">=</span><span class="st">"450"</span><span class="ot"> height</span><span class="op">=</span><span class="st">"283"</span><span class="dt">&gt;</span></span>
<span id="cb13-10"><a href="#cb13-10"></a>            {% endif %}</span>
<span id="cb13-11"><a href="#cb13-11"></a>        <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb13-12"><a href="#cb13-12"></a>        <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">"col-md-5"</span><span class="dt">&gt;</span></span>
<span id="cb13-13"><a href="#cb13-13"></a>            <span class="dt">&lt;</span><span class="kw">h2</span><span class="dt">&gt;</span>Result Media:<span class="dt">&lt;/</span><span class="kw">h2</span><span class="dt">&gt;</span></span>
<span id="cb13-14"><a href="#cb13-14"></a>            {% if original_video %}</span>
<span id="cb13-15"><a href="#cb13-15"></a>                <span class="dt">&lt;</span><span class="kw">video</span><span class="ot"> width</span><span class="op">=</span><span class="st">"450"</span><span class="ot"> height</span><span class="op">=</span><span class="st">"283"</span><span class="ot"> controls src</span><span class="op">=</span><span class="st">"{{ result_media }}"</span><span class="dt">&gt;</span></span>
<span id="cb13-16"><a href="#cb13-16"></a>                <span class="dt">&lt;/</span><span class="kw">video</span><span class="dt">&gt;</span> </span>
<span id="cb13-17"><a href="#cb13-17"></a>            {% else %}</span>
<span id="cb13-18"><a href="#cb13-18"></a>                <span class="dt">&lt;</span><span class="kw">img</span><span class="ot"> src</span><span class="op">=</span><span class="st">"{{ result_media }}"</span><span class="ot"> alt</span><span class="op">=</span><span class="st">"result media"</span><span class="ot"> width</span><span class="op">=</span><span class="st">"450"</span><span class="ot"> height</span><span class="op">=</span><span class="st">"283"</span><span class="dt">&gt;</span></span>
<span id="cb13-19"><a href="#cb13-19"></a>            {% endif %}</span>
<span id="cb13-20"><a href="#cb13-20"></a>        <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb13-21"><a href="#cb13-21"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb13-22"><a href="#cb13-22"></a>{% endif %}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For Django to be able to find our custom templates, we need to add the <code>TEMPLATES</code> path in <code>settings.py</code> as follows:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a>TEMPLATES <span class="op">=</span> [</span>
<span id="cb14-2"><a href="#cb14-2"></a>    {</span>
<span id="cb14-3"><a href="#cb14-3"></a>        ...</span>
<span id="cb14-4"><a href="#cb14-4"></a>        <span class="st">"DIRS"</span>: [BASE_DIR <span class="op">/</span> <span class="st">'object_detection/templates'</span>],</span>
<span id="cb14-5"><a href="#cb14-5"></a>        ...</span>
<span id="cb14-6"><a href="#cb14-6"></a>    },</span>
<span id="cb14-7"><a href="#cb14-7"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="urls-routing" class="level3">
<h3 class="anchored" data-anchor-id="urls-routing">URLs Routing</h3>
<p>In <code>object_detection/urls.py</code> we need to fetch the <code>base</code> and <code>obj_dtc</code> functions (which we’ll discuss in the backend section).</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a><span class="im">from</span> django.urls <span class="im">import</span> path</span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="im">from</span> . <span class="im">import</span> views</span>
<span id="cb15-3"><a href="#cb15-3"></a></span>
<span id="cb15-4"><a href="#cb15-4"></a>urlpatterns <span class="op">=</span> [</span>
<span id="cb15-5"><a href="#cb15-5"></a>    path(<span class="st">''</span>, views.base, name<span class="op">=</span><span class="st">'base'</span>), </span>
<span id="cb15-6"><a href="#cb15-6"></a>    path(<span class="st">'obj_dtc'</span>, views.obj_dtc, name<span class="op">=</span><span class="st">'obj_dtc'</span>) </span>
<span id="cb15-7"><a href="#cb15-7"></a>    </span>
<span id="cb15-8"><a href="#cb15-8"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>We need to let Django know of the existence of these functions’ requests. So, we need to specify their routes in <code>mysite/urls.py</code>.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a><span class="im">from</span> django.contrib <span class="im">import</span> admin </span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="im">from</span> django.urls <span class="im">import</span> include, path</span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="im">from</span> django.conf.urls.static <span class="im">import</span> static</span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="im">from</span> django.conf <span class="im">import</span> settings</span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="im">from</span> object_detection <span class="im">import</span> views <span class="im">as</span> object_detection_views</span>
<span id="cb16-6"><a href="#cb16-6"></a></span>
<span id="cb16-7"><a href="#cb16-7"></a></span>
<span id="cb16-8"><a href="#cb16-8"></a></span>
<span id="cb16-9"><a href="#cb16-9"></a>urlpatterns <span class="op">=</span> [</span>
<span id="cb16-10"><a href="#cb16-10"></a>    path(<span class="st">'admin/'</span>, admin.site.urls),</span>
<span id="cb16-11"><a href="#cb16-11"></a>    path(<span class="st">''</span>, object_detection_views.base, name<span class="op">=</span><span class="st">'base'</span>), </span>
<span id="cb16-12"><a href="#cb16-12"></a>    path(<span class="st">'object_detection/'</span>, include(<span class="st">'object_detection.urls'</span>))</span>
<span id="cb16-13"><a href="#cb16-13"></a>    </span>
<span id="cb16-14"><a href="#cb16-14"></a>] <span class="op">+</span> static(settings.MEDIA_URL, document_root<span class="op">=</span>settings.MEDIA_ROOT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>MEDIA_URL</code> refers to the path for the <code>/media</code> directory, which contains all the image files (both input and output) used by the code. It’s essential to configure this URL so that the templates can locate these images when they are sent from the backend. In other words, the <code>/media</code> directory serves as the connection point that links the backend and the frontend.</p>
</section>
<section id="backend" class="level3">
<h3 class="anchored" data-anchor-id="backend">Backend</h3>
<p>We write all our backend code in <code>object_detection/views.py</code>. It contains four important functions. Let’s take a look at each of them one by one.</p>
<ol type="1">
<li><code>base</code> : This function get the request from the user and renders the results in <code>base.html</code>.</li>
</ol>
<div class="sourceCode" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">def</span> base(request):</span>
<span id="cb17-2"><a href="#cb17-2"></a>    <span class="cf">return</span> render(request, <span class="st">'base.html'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="2" type="1">
<li><code>load_mode</code>: In this function we are creating a YOLO object that gets in our custom model as input.</li>
</ol>
<div class="sourceCode" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">def</span> load_model():</span>
<span id="cb18-2"><a href="#cb18-2"></a>    model_name<span class="op">=</span><span class="st">'yolov8n.pt'</span></span>
<span id="cb18-3"><a href="#cb18-3"></a>    model <span class="op">=</span> YOLO(model_name)</span>
<span id="cb18-4"><a href="#cb18-4"></a>    <span class="cf">return</span> model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="3" type="1">
<li><code>get_prediction</code>: here we pass in the path to the input image/video file uploaded by the user, as well as the model, which is <code>YOLOv10</code> in our case. The output of this function is the relative path to our output image/video file which will be saved inside our <code>/media</code> directory.</li>
</ol>
<div class="sourceCode" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">def</span> get_prediction(media_path, model):</span>
<span id="cb19-2"><a href="#cb19-2"></a>    </span>
<span id="cb19-3"><a href="#cb19-3"></a>    result <span class="op">=</span> model(media_path, conf<span class="op">=</span><span class="fl">0.25</span>, save<span class="op">=</span><span class="va">True</span>, project<span class="op">=</span>settings.MEDIA_ROOT) </span>
<span id="cb19-4"><a href="#cb19-4"></a>    relative_results_dir <span class="op">=</span> os.path.relpath(result[<span class="dv">0</span>].save_dir, settings.MEDIA_ROOT)</span>
<span id="cb19-5"><a href="#cb19-5"></a>    </span>
<span id="cb19-6"><a href="#cb19-6"></a>    <span class="cf">return</span> relative_results_dir</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="4" type="1">
<li><code>obj_dtc</code>: A lot is happening in this function. Let’s break it down:</li>
</ol>
<ul>
<li><p>First, get the request from the user. Retrieve the file name and its full path, and save it in <code>media_full_path</code>.</p></li>
<li><p>Ensure the path exists; if not, inform the user.</p></li>
<li><p>Depending on whether the input file is an image or a video, update the <code>context</code> dictionary. The keys in the dictionary are used to distinguish inputs and outputs, and the values are their corresponding paths (where they have been saved).</p></li>
<li><p>Render the result inside the <code>obj_dtc.html</code> file.</p></li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">def</span> obj_dtc(request):</span>
<span id="cb20-2"><a href="#cb20-2"></a>    <span class="cf">if</span> request.method <span class="op">==</span> <span class="st">'POST'</span> <span class="kw">and</span> request.FILES[<span class="st">'myfile'</span>]:</span>
<span id="cb20-3"><a href="#cb20-3"></a>        myfile <span class="op">=</span> request.FILES[<span class="st">'myfile'</span>]</span>
<span id="cb20-4"><a href="#cb20-4"></a>        fs <span class="op">=</span> FileSystemStorage()</span>
<span id="cb20-5"><a href="#cb20-5"></a>        filename <span class="op">=</span> fs.save(myfile.name, myfile)</span>
<span id="cb20-6"><a href="#cb20-6"></a>        media_path <span class="op">=</span> fs.url(filename)</span>
<span id="cb20-7"><a href="#cb20-7"></a></span>
<span id="cb20-8"><a href="#cb20-8"></a>        model <span class="op">=</span> load_model()</span>
<span id="cb20-9"><a href="#cb20-9"></a>        media_full_path <span class="op">=</span> os.path.join(settings.MEDIA_ROOT, filename)</span>
<span id="cb20-10"><a href="#cb20-10"></a>        </span>
<span id="cb20-11"><a href="#cb20-11"></a>        results_dir <span class="op">=</span> os.path.join(get_prediction(media_full_path, model), filename) </span>
<span id="cb20-12"><a href="#cb20-12"></a></span>
<span id="cb20-13"><a href="#cb20-13"></a>        <span class="cf">if</span> <span class="kw">not</span> os.path.exists(os.path.join(settings.MEDIA_ROOT, results_dir)):</span>
<span id="cb20-14"><a href="#cb20-14"></a>            <span class="cf">return</span> render(request, <span class="st">'obj_dtc.html'</span>, {<span class="st">'error'</span>: <span class="st">'Error in saving predictions'</span>})</span>
<span id="cb20-15"><a href="#cb20-15"></a></span>
<span id="cb20-16"><a href="#cb20-16"></a>        </span>
<span id="cb20-17"><a href="#cb20-17"></a>        <span class="cf">if</span> myfile.name.endswith((<span class="st">'.mp4'</span>, <span class="st">'.avi'</span>)):</span>
<span id="cb20-18"><a href="#cb20-18"></a>            context <span class="op">=</span> {<span class="st">'original_video'</span>: media_path, <span class="st">'result_media'</span>: os.path.join(settings.MEDIA_URL, results_dir)}</span>
<span id="cb20-19"><a href="#cb20-19"></a>        <span class="cf">else</span>:</span>
<span id="cb20-20"><a href="#cb20-20"></a>            context <span class="op">=</span> {<span class="st">'original_image'</span>: media_path, <span class="st">'result_media'</span>: os.path.join(settings.MEDIA_URL, results_dir)}</span>
<span id="cb20-21"><a href="#cb20-21"></a></span>
<span id="cb20-22"><a href="#cb20-22"></a>        <span class="cf">return</span> render(request, <span class="st">'obj_dtc.html'</span>, context)</span>
<span id="cb20-23"><a href="#cb20-23"></a>      </span>
<span id="cb20-24"><a href="#cb20-24"></a>    <span class="cf">return</span> render(request, <span class="st">'obj_dtc.html'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section"></h3>
</section>
<section id="deploy-locally" class="level3">
<h3 class="anchored" data-anchor-id="deploy-locally">Deploy Locally</h3>
<p>Locate to the directory where <code>manage.py</code> is saved, and run the following command:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1"></a>python manage.py runserver</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>There you’ll see your app up and running!</p>
<div class="quarto-video"><video id="video_shortcode_videojs_video2" class="video-js vjs-default-skin vjs-fluid" controls="" preload="auto" data-setup="{}" title=""><source src="demo.mov"></video></div>
<p>This was a really fun project, and I absolutely enjoyed playing around with the code. The successful deployment of this idea was made possible by the diligent work of the researchers at Tsinghua University. You can read their <a href="https://arxiv.org/pdf/2405.14458">paper</a> to learn more about their model design and methodology. For a more hands-on approach to deployment, here is the link to their <a href="https://github.com/THU-MIG/yolov10/tree/main">repository</a>.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<script>videojs(video_shortcode_videojs_video1);</script>
<script>videojs(video_shortcode_videojs_video2);</script>




</body></html>